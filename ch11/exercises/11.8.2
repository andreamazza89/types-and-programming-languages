Gonna take a stab at the new typing rules but not the proof, though will look through the solution.

first a rule for typing a pattern with just a variable:

  t1 : T1  |  x:T1 - t2 : T2
---------------------------
    let x=t1 in t2 : T2

and then the trickier one with records

1. first of all the type of t1 must be a record
2. the li's in the pattern must be a subset of the ones in the evaluated type
3. finally the type of t2 can be evaluated where the context is enriched with all the types from t1

         1                   2                3
  ___________________     _______      _______________
  t1 : {lj..n : Tj..n},   li âŠ† lj  |   lj:Tj - t2 : T2
-----------------------------------------------------------
              let {li=pi..}=t1 in t2 : T2


bleah I'm out of my depth here

